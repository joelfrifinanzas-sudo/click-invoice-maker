@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 210 20% 98%; /* #F9FAFB */
    --foreground: 215 28% 17%; /* #1F2937 */
    --card: 0 0% 100%; /* #FFFFFF */
    --card-foreground: 215 28% 17%;
    --popover: 210 20% 98%;
    --popover-foreground: 215 28% 17%;

    --primary: 234 77% 57%; /* #3C4DE6 */
    --primary-foreground: 0 0% 100%;

    --secondary: 224 15% 20%; /* #2B2F3A */
    --secondary-foreground: 0 0% 100%;

    --muted: 220 14% 96%;
    --muted-foreground: 220 9% 46%; /* #6B7280 */

    --accent: 210 40% 96%;
    --accent-foreground: 215 28% 17%;

    --success: 148 50% 46%; /* #3BB273 */
    --success-foreground: 0 0% 100%;

    --warning: 44 100% 48%; /* #F4B400 */
    --warning-foreground: 215 28% 17%;

    --destructive: 7 80% 56%; /* #E94B35 */
    --destructive-foreground: 0 0% 100%;

    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 234 77% 57%;

    /* Button tokens */
    --btn-primary: 234 77% 57%; /* #3C4DE6 */
    --btn-primary-hover: 235 61% 48%; /* #2F3BC4 */
    --btn-primary-active: 235 64% 42%; /* ~#2632A3 */
    --btn-primary-foreground: 0 0% 100%;

    --btn-secondary: 206 19% 96%; /* #F4F6F8 */
    --btn-secondary-hover: 220 14% 91%; /* #E5E7EB */
    --btn-secondary-active: 220 12% 87%; /* slightly darker */
    --btn-secondary-foreground: 215 28% 17%; /* #1F2937 */
    --btn-secondary-border: 220 12% 84%; /* #D1D5DB */

    --btn-success: 148 50% 46%; /* #3BB273 */
    --btn-success-hover: 149 51% 37%; /* #2E8E5C */
    --btn-success-active: 149 52% 32%;
    --btn-success-foreground: 0 0% 100%;

    --btn-warning: 44 100% 48%; /* #F4B400 */
    --btn-warning-hover: 44 100% 44%; /* #DFA200 */
    --btn-warning-active: 44 100% 39%;
    --btn-warning-foreground: 0 0% 100%;

    --btn-destructive: 7 80% 56%; /* #E94B35 */
    --btn-destructive-hover: 7 64% 47%; /* #C63D2B */
    --btn-destructive-active: 7 64% 42%;
    --btn-destructive-foreground: 0 0% 100%;

    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;

    --radius: 0.75rem;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 234 77% 57%;
    --primary-foreground: 0 0% 100%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 7 80% 56%;
    --destructive-foreground: 210 40% 98%;
    --success: 148 50% 46%;
    --success-foreground: 0 0% 100%;
    --warning: 44 100% 48%;
    --warning-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 234 77% 57%;

    /* Button tokens (dark uses same to ensure brand consistency & AA) */
    --btn-primary: 234 77% 57%;
    --btn-primary-hover: 235 61% 48%;
    --btn-primary-active: 235 64% 42%;
    --btn-primary-foreground: 0 0% 100%;

    --btn-secondary: 206 19% 96%;
    --btn-secondary-hover: 220 14% 91%;
    --btn-secondary-active: 220 12% 87%;
    --btn-secondary-foreground: 215 28% 17%;
    --btn-secondary-border: 220 12% 84%;

    --btn-success: 148 50% 46%;
    --btn-success-hover: 149 51% 37%;
    --btn-success-active: 149 52% 32%;
    --btn-success-foreground: 0 0% 100%;

    --btn-warning: 44 100% 48%;
    --btn-warning-hover: 44 100% 44%;
    --btn-warning-active: 44 100% 39%;
    --btn-warning-foreground: 0 0% 100%;

    --btn-destructive: 7 80% 56%;
    --btn-destructive-hover: 7 64% 47%;
    --btn-destructive-active: 7 64% 42%;
    --btn-destructive-foreground: 0 0% 100%;

    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Custom design system tokens */
:root {
  /* Spacing scale (8px system) */
  --space-1: 0.25rem; /* 4px */
  --space-2: 0.5rem;  /* 8px */
  --space-3: 0.75rem; /* 12px */
  --space-4: 1rem;    /* 16px */
  --space-6: 1.5rem;  /* 24px */
  --space-8: 2rem;    /* 32px */
  
  /* Typography scale */
  --text-xs: 0.75rem;     /* 12px */
  --text-sm: 0.875rem;    /* 14px */
  --text-base: 1rem;      /* 16px */
  --text-lg: 1.125rem;    /* 18px */
  --text-xl: 1.25rem;     /* 20px */
  --text-2xl: 1.5rem;     /* 24px */
  --text-3xl: 1.875rem;   /* 30px */
  
  /* Line heights */
  --leading-tight: 1.25;
  --leading-normal: 1.5;
  --leading-relaxed: 1.625;
  
  /* Touch targets */
  --touch-target: 44px; /* legacy var */
  --touch-target-min: 44px;
  --touch-target-comfortable: 48px;

  /* Layout */
  --max-width-content: 1200px;

  /* Derived color shades (HSL) */
  --primary-light: 234 77% 64%;
  --primary-dark: 234 77% 47%;

  /* Gradients */
  --gradient-primary: linear-gradient(135deg, hsl(var(--primary)) 0%, hsl(var(--primary) / 0.85) 100%);
  --gradient-secondary: linear-gradient(180deg, hsl(var(--secondary) / 0.12), transparent);
  --gradient-subtle: linear-gradient(180deg, hsl(var(--background)) 0%, hsl(var(--muted)) 100%);
  --gradient-hero: radial-gradient(1200px circle at 10% 10%, hsl(var(--primary) / 0.18), transparent 40%), radial-gradient(1000px circle at 90% 20%, hsl(var(--secondary) / 0.18), transparent 40%);

  /* Shadows (use HSL with alpha) */
  --shadow-sm: 0 1px 2px 0 hsl(0 0% 0% / 0.05);
  --shadow-card: 0 4px 12px -2px hsl(0 0% 0% / 0.08), 0 8px 24px -4px hsl(0 0% 0% / 0.04);
  --shadow-lg: 0 10px 30px -10px hsl(var(--primary) / 0.25);
  --shadow-invoice: 0 8px 32px -8px hsl(var(--primary) / 0.30), 0 4px 16px -4px hsl(0 0% 0% / 0.10);
  --shadow-soft: 0 2px 8px -2px hsl(0 0% 0% / 0.10), 0 4px 16px -4px hsl(0 0% 0% / 0.06);

  /* Transitions */
  --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: all 0.45s cubic-bezier(0.4, 0, 0.2, 1);

  /* Sidebar tokens */
  --sidebar-background: 224 15% 20%; /* matches secondary */
  --sidebar-foreground: 210 40% 98%;
  --sidebar-primary: 234 77% 57%;
  --sidebar-primary-foreground: 0 0% 100%;
  --sidebar-accent: 217.2 32.6% 17.5%;
  --sidebar-accent-foreground: 210 40% 98%;
  --sidebar-border: 220 12% 20%;
  --sidebar-ring: 234 77% 57%;

  /* Safe areas */
  --safe-area-top: env(safe-area-inset-top);
  --safe-area-bottom: env(safe-area-inset-bottom);
  --safe-area-left: env(safe-area-inset-left);
  --safe-area-right: env(safe-area-inset-right);
}

/* Base typography improvements */
body {
  font-family: 'Poppins', 'Inter', 'ui-sans-serif', 'system-ui', sans-serif;
  font-size: var(--text-base);
  line-height: var(--leading-normal);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Headings and buttons use Montserrat by default for typography */
h1, h2, h3, h4, h5, h6,
button,
.button,
.btn {
  font-family: 'Montserrat', 'Poppins', 'ui-sans-serif', 'system-ui', sans-serif;
  font-weight: 600;
}

/* Responsive typography utilities */
.text-responsive-xs { font-size: clamp(0.75rem, 2vw, 0.875rem); }
.text-responsive-sm { font-size: clamp(0.875rem, 2.5vw, 1rem); }
.text-responsive-base { font-size: clamp(1rem, 3vw, 1.125rem); }
.text-responsive-lg { font-size: clamp(1.125rem, 3.5vw, 1.25rem); }
.text-responsive-xl { font-size: clamp(1.25rem, 4vw, 1.5rem); }
.text-responsive-2xl { font-size: clamp(1.5rem, 4.5vw, 1.875rem); }
.text-responsive-3xl { font-size: clamp(1.875rem, 5vw, 2.25rem); }

/* Touch target utilities */
.touch-target {
  min-height: var(--touch-target);
  min-width: var(--touch-target);
}

/* Focus improvements for accessibility */
.focus-visible\:outline-none:focus-visible {
  outline: 2px solid transparent;
  outline-offset: 2px;
}

.focus-visible\:ring-2:focus-visible {
  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
}

/* Custom shadows for depth */
.shadow-soft {
  box-shadow: 0 2px 8px -2px rgba(0, 0, 0, 0.1), 0 4px 16px -4px rgba(0, 0, 0, 0.06);
}

.shadow-card {
  box-shadow: 0 4px 12px -2px rgba(0, 0, 0, 0.08), 0 8px 24px -4px rgba(0, 0, 0, 0.04);
}

.shadow-invoice {
  box-shadow: 0 8px 32px -8px rgba(59, 130, 246, 0.3), 0 4px 16px -4px rgba(0, 0, 0, 0.1);
}

/* Gradient utilities */
.bg-gradient-primary {
  background: linear-gradient(135deg, hsl(var(--primary)) 0%, hsl(var(--primary) / 0.8) 100%);
}

/* Layout utilities */
.main-layout {
  min-height: 100vh;
  min-height: 100dvh; /* Dynamic viewport height for mobile */
}

.sidebar-content {
  /* Smooth transitions for sidebar interactions */
  transition: padding-left 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* Auto-hide header utilities */
.header-visible {
  transform: translateY(0);
  transition: transform 0.3s ease-in-out;
}

.header-hidden {
  transform: translateY(-100%);
  transition: transform 0.3s ease-in-out;
}

/* Container improvements */
.container {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  padding-left: 1rem;
  padding-right: 1rem;
}

@media (min-width: 640px) {
  .container {
    max-width: 640px;
  }
}

@media (min-width: 768px) {
  .container {
    max-width: 768px;
  }
}

@media (min-width: 1024px) {
  .container {
    max-width: 1024px;
    padding-left: 2rem;
    padding-right: 2rem;
  }
}

@media (min-width: 1280px) {
  .container {
    max-width: 1200px;
  }
}

/* Form improvements */
input, textarea, select {
  font-size: 16px; /* Prevents zoom on iOS */
}

/* Button improvements */
button {
  touch-action: manipulation; /* Prevents double-tap zoom */
}

/* Scroll behavior */
html {
  scroll-behavior: smooth;
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
  
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Image optimizations */
img {
  max-width: 100%;
  height: auto;
}

/* Z-index utilities */
.z-header { z-index: 40; }
.z-sidebar { z-index: 30; }
.z-modal { z-index: 50; }
.z-toast { z-index: 60; }
.z-tooltip { z-index: 70; }

/* Mobile mode trigger - applied via useIsMobile hook */
html.is-mobile {
  /* Root flag – scoped rules below */
}

/* Mobile typography clamp */
html.is-mobile h1 { font-size: clamp(20px, 4.8vw, 24px); line-height: 1.3; }
html.is-mobile h2 { font-size: clamp(18px, 4.2vw, 22px); line-height: 1.35; }
html.is-mobile body { font-size: 16px; line-height: 1.5; }

/* Safe-area utilities */
.safe-area-pb { padding-bottom: calc(env(safe-area-inset-bottom) + 0.5rem); }
.safe-area-pt { padding-top: calc(env(safe-area-inset-top) + 0.5rem); }

/* Sticky bottom primary action on mobile */
html.is-mobile .mobile-sticky-action {
  position: sticky;
  bottom: calc(env(safe-area-inset-bottom) + 0.75rem);
  padding-bottom: env(safe-area-inset-bottom);
  background: transparent;
  z-index: 10;
}

/* Mobile popper width fix */
@media (max-width: 768px) {
  [data-radix-popper-content-wrapper],
  [data-radix-select-content],
  [data-radix-dropdown-menu-content] {
    max-width: calc(100vw - 2rem);
    left: 1rem !important;
    right: 1rem !important;
    transform: none !important;
  }
}
